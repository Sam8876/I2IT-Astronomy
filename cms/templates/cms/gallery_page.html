{% extends "blogapp/base.html" %}
{% load wagtailimages_tags %}
{% load static %}

{% block content %}
<div class="gallery-wrapper">
    {% for category in page.categories.all %}
        <h2 class="category-title">{{ category.title }}</h2>

        <div class="carousel-container">
            <div class="carousel-track">
                {% for gallery_image in category.images.all %}
                    {% image gallery_image.image fill-800x450 as img %}
                    <div class="carousel-item">
                        <img src="{{ img.url }}" alt="{{ img.alt }}">
                    </div>
                {% endfor %}
                {# duplicate images for infinite scrolling #}
                {% for gallery_image in category.images.all %}
                    {% image gallery_image.image fill-800x450 as img %}
                    <div class="carousel-item">
                        <img src="{{ img.url }}" alt="{{ img.alt }}">
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endfor %}
</div>

<style>
body, html {
    background-image: url("{% static 'images/starry.jpg' %}");
    object-fit: cover;
}

/* Wrapper */
.gallery-wrapper {
    margin-top: 10vh;
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 90vw;
    max-width: 1400px;
    overflow: hidden;
    text-align: center;
    padding: 15px 3vw 6vh 3vw;
    border-radius: 25px;
    background-color: rgba(27,27,27,0.9);
}

.category-title {
    font-size: 2vw;
    color: #fff;
    margin: 2rem 0 1rem;
    text-align: left;
}

/* Carousel */
.carousel-container {
    position: relative;
    width: 100%;
    overflow: hidden;
    margin-bottom: 2rem;
}

.carousel-track {
    display: flex;
    gap: 1rem;
    animation: scroll 10s linear infinite;
}

.carousel-container:hover .carousel-track {
    animation-play-state: paused;
}

.carousel-item {
    flex: 0 0 auto;
    transition: transform 0.3s ease, filter 0.3s ease;
}

.carousel-item img {
    width: 60vw;               /* fluid size */
    max-width: 500px;          /* cap for desktop */
    min-width: 250px;          /* stop shrinking too small */
    aspect-ratio: 16 / 9;
    object-fit: cover;
    border: 2px solid white;
    border-radius: 12px;
    filter: brightness(0.85);
    box-shadow: 0 0 8px white;
    cursor: pointer;
}

/* Hover effect */
.carousel-item:hover {
    transform: scale(1.08);
    z-index: 5;
}

.carousel-item:hover img {
    filter: brightness(1);
}

/* Infinite scroll keyframes */
@keyframes scroll {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
}

/* ðŸ“± Mobile Optimizations */
@media (max-width: 768px) {
    .gallery-wrapper {
        width: 95vw;
        padding: 10px 2vw 4vh;
        border-radius: 15px;
    }

    .carousel-item img {
        width: 85vw;
        min-width: 200px;
        border-radius: 10px;
    }

    .category-title {
        font-size: 1.2rem;
        margin: 1.5rem 0 0.5rem;
    }
}

@media (max-width: 480px) {
    .carousel-item img {
        width: 90vw;
        min-width: 180px;
    }

    .category-title {
        font-size: 1rem;
    }
}
</style>

<script>
    let element = document.getElementById("gallerybtn");
    if (element) {
        element.style.border = "2px solid rgb(61, 106, 255)";
    }
</script>
{% endblock %}
